generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

enum Role {
  ADMIN
  USER
}

model User {
  id           Int             @id @default(autoincrement())
  username     String          @unique
  passwordHash String
  role         Role            @default(USER)
  memes        Meme[]
  likes        UserLikesMeme[]
  createdAt    DateTime        @default(now())
  updatedAt    DateTime        @updatedAt
}

model Meme {
  id        Int             @id @default(autoincrement())
  title     String
  url       String
  userId    Int
  user      User            @relation(fields: [userId], references: [id])
  likes     UserLikesMeme[]
  createdAt DateTime        @default(now())
  updatedAt DateTime        @updatedAt
}

model UserLikesMeme {
  id     Int  @id @default(autoincrement())
  user   User @relation(fields: [userId], references: [id])
  meme   Meme @relation(fields: [memeId], references: [id])
  userId Int
  memeId Int

  @@unique([userId, memeId])
}
